(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-52a5"],{Ampy:function(e,t,a){},Gsba:function(e,t,a){"use strict";var r={name:"Mysearch",props:{hidden:{type:Boolean,default:!1},placeholder:{type:String,default:"请输入关键字(模糊搜索)"},buttonName:{type:String,default:"搜索"},value:{type:String,default:""}},data:function(){return{new_search:this.value}},methods:{to_search:function(){this.$emit("searchData",this.new_search)},to_input:function(){this.$emit("input",this.new_search)}}},n=(a("qq43"),a("KHd+")),o=Object(n.a)(r,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:{hidden:e.hidden}},[a("el-input",{attrs:{placeholder:e.placeholder,size:"small",clearable:""},on:{input:e.to_input,clear:e.to_search},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.to_search(t):null}},model:{value:e.new_search,callback:function(t){e.new_search=t},expression:"new_search"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.to_search},slot:"append"},[e._v(e._s(e.buttonName))])],1)],1)},[],!1,null,"d300708c",null);o.options.__file="index2.vue";t.a=o.exports},Mz3J:function(e,t,a){"use strict";var r={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},page_size:{type:Number,default:10},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(e){this.$emit("update:page",e)}},pageSize:{get:function(){return this.page_size},set:function(e){this.$emit("update:page_size",e)}}},methods:{handleSizeChange:function(e){this.$emit("pagination",{page:this.currentPage,page_size:e})},handleCurrentChange:function(e){this.$emit("pagination",{page:e,page_size:this.pageSize})}}},n=(a("e+pk"),a("KHd+")),o=Object(n.a)(r,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:{hidden:e.hidden}},[a("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)},[],!1,null,"88e53666",null);o.options.__file="index.vue";t.a=o.exports},OiJS:function(e,t,a){},"Vo/T":function(e,t,a){},"e+pk":function(e,t,a){"use strict";var r=a("OiJS");a.n(r).a},"ed+m":function(e,t,a){"use strict";var r=a("Vo/T");a.n(r).a},eivq:function(e,t,a){"use strict";a.d(t,"b",function(){return n}),a.d(t,"d",function(){return o}),a.d(t,"c",function(){return l}),a.d(t,"a",function(){return i});var r=a("t3Un");function n(e,t){return Object(r.a)({url:e,method:"get",params:t})}function o(e,t){return Object(r.a)({url:e,method:"post",data:t})}function l(e,t){return Object(r.a)({url:e,method:"patch",data:t})}function i(e,t){return Object(r.a)({url:e,method:"delete",data:t})}},leTS:function(e,t,a){"use strict";a.r(t);var r=a("FyfS"),n=a.n(r),o=(a("Q2AE"),a("eivq")),l=a("Gsba"),i=a("Mz3J"),s={name:"DepartManage",components:{Mysearch:l.a,Pagination:i.a},filters:{statusFilter:function(e){return e?"正常":"冻结"},customRightFilter:function(e){return e?"开启":"关闭"}},data:function(){return{centerDialog:!1,centerDialog_delete:!1,centerDialog_patch:!1,menuVisible:!1,firstLevel:!1,activeName:"dept",parentDepartName:"",currentData:"",currentNode:"",page_datas:[],deptTree:[],defaultProps:{children:"children",label:"depart_name"},ruleForm:{depart_name:"",org_type:"",org_category:"",sort:"",content:""},rules:{depart_name:[{required:!0,message:"请输入部门名称",trigger:"blur"}],depart_name_en:[{required:!1,message:"请输入英文名称",trigger:"blur"}],sort:[{required:!0,message:"请输入排序",trigger:"blur"}],parent_id:[{required:!1,message:"请选择上级部门",trigger:"change"}]},ruleForm_patch:{},rules_patch:{},delete_data:{},my_pagination:{page:1,page_size:10,count:0,search:"",search_type:"",depart_id:void 0},auth_datas:[]}},created:function(){this.queryDeptTree()},methods:{queryDeptTree:function(){var e=this;Object(o.b)("/departTree/").then(function(t){0==t.errorCode&&(e.deptTree=t.data)})},getDepartUser:function(e){var t=this;Object(o.b)("/departUser/",e).then(function(e){var a=e.data;t.page_datas=a,t.my_pagination.count=e.count})},queryById:function(e){var t=this;Object(o.b)("/depart/"+e+"/").then(function(e){t.parentDepartName=e.data.depart_name}).catch(function(){t.parentDepartName=""})},getRow:function(e){return function e(t,a){var r=!0,o=!1,l=void 0;try{for(var i,s=n()(t);!(r=(i=s.next()).done);r=!0){var c=i.value;if(c.id===a)return c;if(c.children instanceof Array){var u=e(c.children,a);if(null!=u)return u}}}catch(e){o=!0,l=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw l}}return null}(this.deptTree,e)},handleClickTab:function(e,t){console.log("tab",e),"user"==this.activeName&&this.getDepartUser(this.my_pagination)},post_need_data:function(e){var t=this;Object(o.d)("/depart/",e).then(function(e){e.data;t.centerDialog=!1,t.$refs.ruleForm.resetFields(),t.$message({showClose:!0,message:"新增成功！",type:"success"}),t.queryDeptTree()})},patch_need_data:function(e){var t=this;Object(o.c)("/depart/"+e.id+"/",e).then(function(e){e.data;t.centerDialog_patch=!1,t.$message({showClose:!0,message:"修改成功！",type:"success"}),t.queryDeptTree()})},delete_need_data:function(e){var t=this;Object(o.a)("/depart/"+e.id+"/",e).then(function(e){e.data;t.centerDialog_delete=!1,t.$message({showClose:!0,message:"删除成功！",type:"success"}),t.queryDeptTree()})},submitForm:function(e){var t=this;this.$refs[e].validate(function(a){if(!a)return console.log("error submit!!"),!1;"ruleForm"==e?t.post_need_data(t.ruleForm):t.patch_need_data(t.ruleForm_patch)})},resetForm:function(e){this.centerDialog=!1,this.centerDialog_patch=!1,this.$refs[e].resetFields()},addData:function(){this.ruleForm.org_category=1,this.ruleForm.org_type=1,this.ruleForm.parent_id=0,this.centerDialog=!0},true_delete:function(){this.delete_need_data(this.currentData)},to_search:function(){this.my_pagination.page=1,this.getDepartUser(this.my_pagination)},pag_change:function(){this.getDepartUser(this.my_pagination)},search_change:function(){this.getDepartUser(this.my_pagination)},my_change:function(e){this.my_pagination.page=1,this.my_pagination.search_type=e,this.getDepartUser(this.my_pagination)},handleNodeClick:function(e){this.currentData=e,this.my_pagination.depart_id=this.currentData.id,this.foo(),this.ruleForm_patch={id:this.currentData.id,parent_id:this.currentData.parent_id,depart_name:this.currentData.depart_name,depart_name_en:this.currentData.depart_name_en,org_type:this.currentData.org_type,org_category:this.currentData.org_category,org_code:this.currentData.org_code,sort:this.currentData.sort,content:this.currentData.content};var t=this.getRow(this.currentData.parent_id);this.parentDepartName=t?t.depart_name:"","user"==this.activeName&&this.getDepartUser(this.my_pagination)},foo:function(){this.menuVisible=!1,document.removeEventListener("click",this.foo)},rightClick:function(e,t,a,r){this.currentData=t,this.currentNode=a,1===a.level?this.firstLevel=!0:this.firstLevel=!1,this.menuVisible=!0,document.addEventListener("click",this.foo),this.$refs.card.$el.style.left=e.clientX-150+"px",this.$refs.card.$el.style.top=e.clientY-60+"px"},addChildNode:function(){this.ruleForm.org_category=2,this.ruleForm.org_type=2,this.ruleForm.parent_id=this.currentData.id,this.parentDepartName=this.currentData.depart_name,this.centerDialog=!0},deleteNode:function(){this.centerDialog_delete=!0},editNode:function(){this.ruleForm_patch={id:this.currentData.id,parent_id:this.currentData.parent_id,depart_name:this.currentData.depart_name,depart_name_en:this.currentData.depart_name_en,org_type:this.currentData.org_type,org_category:this.currentData.org_category,org_code:this.currentData.org_code,sort:this.currentData.sort,content:this.currentData.content},this.queryById(this.currentData.parent_id),this.centerDialog_patch=!0}}},c=(a("xhah"),a("ed+m"),a("KHd+")),u=Object(c.a)(s,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-row",{staticStyle:{height:"100%"}},[a("el-col",{staticStyle:{height:"100%"},attrs:{span:6}},[a("div",{staticClass:"left-side-dept"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.addData}},[e._v("添加一级部门")]),e._v(" "),a("el-tree",{ref:"tree",attrs:{data:e.deptTree,props:e.defaultProps,"expand-on-click-node":!1,"node-key":"id","default-expand-all":""},on:{"node-contextmenu":e.rightClick,"node-click":e.handleNodeClick}})],1)]),e._v(" "),a("el-col",{attrs:{span:18}},[a("el-tabs",{on:{"tab-click":e.handleClickTab},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"部门信息",name:"dept"}},[a("el-form",{ref:"ruleForm_patch",attrs:{model:e.ruleForm_patch,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"部门名称",prop:"depart_name"}},[a("el-input",{attrs:{size:"small"},model:{value:e.ruleForm_patch.depart_name,callback:function(t){e.$set(e.ruleForm_patch,"depart_name",t)},expression:"ruleForm_patch.depart_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"部门类别",prop:"org_category"}},[a("el-radio-group",{model:{value:e.ruleForm_patch.org_category,callback:function(t){e.$set(e.ruleForm_patch,"org_category",t)},expression:"ruleForm_patch.org_category"}},[1==e.ruleForm_patch.org_category?a("el-radio",{attrs:{label:1}},[e._v("一级部门")]):e._e(),e._v(" "),1!==e.ruleForm_patch.org_category?a("el-radio",{attrs:{label:2}},[e._v("机关部门")]):e._e(),e._v(" "),1!==e.ruleForm_patch.org_category?a("el-radio",{attrs:{label:3}},[e._v("非机关部门")]):e._e()],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"上级部门",prop:"parent_id"}},[a("el-input",{attrs:{size:"small",disabled:""},model:{value:e.parentDepartName,callback:function(t){e.parentDepartName=t},expression:"parentDepartName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"部门编码",prop:"org_code"}},[a("el-input",{attrs:{size:"small",disabled:""},model:{value:e.ruleForm_patch.org_code,callback:function(t){e.$set(e.ruleForm_patch,"org_code",t)},expression:"ruleForm_patch.org_code"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"排序",prop:"sort"}},[a("el-input",{attrs:{size:"small"},model:{value:e.ruleForm_patch.sort,callback:function(t){e.$set(e.ruleForm_patch,"sort",t)},expression:"ruleForm_patch.sort"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"部门说明",prop:"content"}},[a("el-input",{attrs:{size:"small",type:"textarea"},model:{value:e.ruleForm_patch.content,callback:function(t){e.$set(e.ruleForm_patch,"content",t)},expression:"ruleForm_patch.content"}})],1)],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.submitForm("ruleForm_patch")}}},[e._v("修 改")])],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"用户列表",name:"user"}},[a("el-row",[a("el-col",{attrs:{span:10}},[a("p")]),e._v(" "),a("el-col",{attrs:{span:8}},[a("p")]),e._v(" "),a("el-col",{attrs:{span:6}},[a("mysearch",{on:{searchData:e.to_search},model:{value:e.my_pagination.search,callback:function(t){e.$set(e.my_pagination,"search",t)},expression:"my_pagination.search"}})],1)],1),e._v(" "),a("br"),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.page_datas,border:"",stripe:"",size:"mini"}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"60"}}),e._v(" "),a("el-table-column",{attrs:{prop:"username",label:"用户名"}}),e._v(" "),a("el-table-column",{attrs:{prop:"real_name",label:"姓名"}}),e._v(" "),a("el-table-column",{attrs:{prop:"depart_name",label:"所属部门"}}),e._v(" "),a("el-table-column",{attrs:{prop:"manage_depart_name",label:"管理部门"}}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:t.row.status?"success":"danger","disable-transitions":""}},[e._v(e._s(e._f("statusFilter")(t.row.status)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"custom_right",label:"自定义充值"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:t.row.custom_right?"success":"danger","disable-transitions":""}},[e._v(e._s(e._f("customRightFilter")(t.row.custom_right)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"group.group_type_cn",label:"角色"}}),e._v(" "),a("el-table-column",{attrs:{prop:"content",label:"备注"}})],1),e._v(" "),a("br"),e._v(" "),a("pagination",{attrs:{total:e.my_pagination.count,page:e.my_pagination.page,page_size:e.my_pagination.page_size},on:{"update:page":function(t){e.$set(e.my_pagination,"page",t)},"update:page_size":function(t){e.$set(e.my_pagination,"page_size",t)},pagination:e.pag_change}})],1)],1)],1)],1),e._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{visible:e.centerDialog,"close-on-press-escape":!1,"close-on-click-modal":!1,title:"新增",width:"40%",center:""},on:{"update:visible":function(t){e.centerDialog=t}}},[a("div",[a("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"部门名称",prop:"depart_name"}},[a("el-input",{attrs:{size:"small"},model:{value:e.ruleForm.depart_name,callback:function(t){e.$set(e.ruleForm,"depart_name",t)},expression:"ruleForm.depart_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"部门类别",prop:"org_category"}},[a("el-radio-group",{model:{value:e.ruleForm.org_category,callback:function(t){e.$set(e.ruleForm,"org_category",t)},expression:"ruleForm.org_category"}},[1==e.ruleForm.org_category?a("el-radio",{attrs:{label:1}},[e._v("一级部门")]):e._e(),e._v(" "),1!==e.ruleForm.org_category?a("el-radio",{attrs:{label:2}},[e._v("机关部门")]):e._e(),e._v(" "),1!==e.ruleForm.org_category?a("el-radio",{attrs:{label:3}},[e._v("非机关部门")]):e._e()],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"上级部门",prop:"parent_id"}},[a("el-input",{attrs:{size:"small",disabled:""},model:{value:e.parentDepartName,callback:function(t){e.parentDepartName=t},expression:"parentDepartName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"排序",prop:"sort"}},[a("el-input",{attrs:{size:"small"},model:{value:e.ruleForm.sort,callback:function(t){e.$set(e.ruleForm,"sort",t)},expression:"ruleForm.sort"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"部门说明",prop:"content"}},[a("el-input",{attrs:{size:"small",type:"textarea"},model:{value:e.ruleForm.content,callback:function(t){e.$set(e.ruleForm,"content",t)},expression:"ruleForm.content"}})],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.resetForm("ruleForm")}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.submitForm("ruleForm")}}},[e._v("确 定")])],1)]),e._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{visible:e.centerDialog_delete,title:"确认删除",width:"30%",center:""},on:{"update:visible":function(t){e.centerDialog_delete=t}}},[a("span",[e._v("是否确认删除，删除后不可恢复？")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.centerDialog_delete=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.true_delete}},[e._v("确 定")])],1)]),e._v(" "),a("el-dialog",{attrs:{visible:e.centerDialog_patch,"close-on-press-escape":!1,"close-on-click-modal":!1,title:"编辑",width:"50%",center:""},on:{"update:visible":function(t){e.centerDialog_patch=t}}},[a("div",[a("el-form",{ref:"ruleForm_patch",attrs:{model:e.ruleForm_patch,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"部门名称",prop:"depart_name"}},[a("el-input",{attrs:{size:"small"},model:{value:e.ruleForm_patch.depart_name,callback:function(t){e.$set(e.ruleForm_patch,"depart_name",t)},expression:"ruleForm_patch.depart_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"部门类别",prop:"org_category"}},[a("el-radio-group",{model:{value:e.ruleForm_patch.org_category,callback:function(t){e.$set(e.ruleForm_patch,"org_category",t)},expression:"ruleForm_patch.org_category"}},[1==e.ruleForm_patch.org_category?a("el-radio",{attrs:{label:1}},[e._v("一级部门")]):e._e(),e._v(" "),1!==e.ruleForm_patch.org_category?a("el-radio",{attrs:{label:2}},[e._v("机关部门")]):e._e(),e._v(" "),1!==e.ruleForm_patch.org_category?a("el-radio",{attrs:{label:3}},[e._v("非机关部门")]):e._e()],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"上级部门",prop:"parent_id"}},[a("el-input",{attrs:{size:"small",disabled:""},model:{value:e.parentDepartName,callback:function(t){e.parentDepartName=t},expression:"parentDepartName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"部门编码",prop:"org_code"}},[a("el-input",{attrs:{size:"small",disabled:""},model:{value:e.ruleForm_patch.org_code,callback:function(t){e.$set(e.ruleForm_patch,"org_code",t)},expression:"ruleForm_patch.org_code"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"排序",prop:"sort"}},[a("el-input",{attrs:{size:"small"},model:{value:e.ruleForm_patch.sort,callback:function(t){e.$set(e.ruleForm_patch,"sort",t)},expression:"ruleForm_patch.sort"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"部门说明",prop:"content"}},[a("el-input",{attrs:{size:"small",type:"textarea"},model:{value:e.ruleForm_patch.content,callback:function(t){e.$set(e.ruleForm_patch,"content",t)},expression:"ruleForm_patch.content"}})],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.resetForm("ruleForm_patch")}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.submitForm("ruleForm_patch")}}},[e._v("确 定")])],1)]),e._v(" "),a("el-card",{directives:[{name:"show",rawName:"v-show",value:e.menuVisible,expression:"menuVisible"}],ref:"card",staticClass:"box-card"},[a("div",{staticClass:"add",on:{click:function(t){e.addChildNode()}}},[a("i",{staticClass:"el-icon-circle-plus-outline"}),e._v("  子级增加\n    ")]),e._v(" "),a("div",{staticClass:"delete",on:{click:function(t){e.deleteNode()}}},[a("i",{staticClass:"el-icon-remove-outline"}),e._v("  删除节点\n    ")]),e._v(" "),a("div",{staticClass:"edit",on:{click:function(t){e.editNode()}}},[a("i",{staticClass:"el-icon-edit"}),e._v("  修改节点\n    ")])])],1)},[],!1,null,"9fc7fc24",null);u.options.__file="depart.vue";t.default=u.exports},qq43:function(e,t,a){"use strict";var r=a("Ampy");a.n(r).a},qsva:function(e,t,a){},xhah:function(e,t,a){"use strict";var r=a("qsva");a.n(r).a}}]);